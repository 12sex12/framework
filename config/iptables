# IPv4
iptables -F
iptables -X
iptables -P INPUT DROP
iptables -P FORWARD DROP
iptables -P OUTPUT ACCEPT
iptables -A INPUT -i lo -j ACCEPT
iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
iptables -N MC
iptables -A INPUT -p tcp --dport 25565 -j MC
iptables -A INPUT -p udp --dport 19132 -j MC
iptables -A MC -p tcp --syn --dport 25565 -m connlimit --connlimit-above 5 --connlimit-mask 32 -j REJECT --reject-with tcp-reset
iptables -A MC -p udp --dport 19132 -j DROP
iptables-save > /etc/iptables/rules.v4

# IPv6
ip6tables -F
ip6tables -X
ip6tables -P INPUT DROP
ip6tables -P FORWARD DROP
ip6tables -P OUTPUT ACCEPT
ip6tables -A INPUT -i lo -j ACCEPT
ip6tables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
ip6tables -N MC
ip6tables -A INPUT -p tcp --dport 25565 -j MC
ip6tables -A INPUT -p udp --dport 19132 -j MC
ip6tables -A MC -p tcp --syn --dport 25565 -m connlimit --connlimit-above 5 --connlimit-mask 64 -j REJECT --reject-with tcp-reset
ip6tables -A MC -p udp --dport 19132 -j DROP
ip6tables-save > /etc/iptables/rules.v6
